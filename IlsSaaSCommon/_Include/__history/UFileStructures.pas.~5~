unit UFileStructures;
//------------------------------------------------------------------------------
// все файловые структуры собраны тут
//
// !!! ВАЖНО !!!
//  размер абсолютно всех файловых структур должен быть кратен 8 байт
//  добавляйте пустое поле в конце при необходимости
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
interface

uses
  UGeoPosition;

//------------------------------------------------------------------------------
type

//------------------------------------------------------------------------------
//! министруктура гео-хэш вектор
//------------------------------------------------------------------------------
  PHashVector = ^THashVector;

  THashVector = packed record
    //! откуда
    PointFrom: Int64; // 8
    //! куда
    PointTo: Int64; // 16
  end;

//------------------------------------------------------------------------------\
//! запись в файле графов "дороги"
//------------------------------------------------------------------------------
  PEdge = ^TEdge;

  TEdge = packed record
    //! гео-хэш вектора начало/конец
    VectorHash: Int64; // 16
    //! гео-координаты начала
    CoordsFrom: TGeoPosition; // 32
    //! гео-координаты конца
    CoordsTo: TGeoPosition; // 48
    //! длина дороги, км
    Distance: Double; // 56
    //! максимальная скорость на дороге, км/ч
    MaxSpeed: Integer; // 60
    //! тип дороги
    RoadType: Integer; // 64
    //! количество дорог в файле списка дорог
    ListCount: Integer; // 68
    //! смещение в файле списка дорог ".list_*"
    ListOffset: Int64; // 72
    //! количество промежуточных точек (может быть 0)
    WayCount: Integer; // 76
    //! смещение в файле промежуточных точек ".way" (-1 если их нет)
    WayOffset: Int64; // 80
    //! ID из OSM (!!! отладка !!!)
    ID: Int64; // 88
    //! 128 байт (!!! отладка !!!)
    Dummy: Int64; // 96
  end;

  TEdgeArray = TArray<TEdge>;

//------------------------------------------------------------------------------
//! запись в файле графов "список дорог"
//------------------------------------------------------------------------------
  PEdgeList = ^TEdgeList;

  TEdgeList = packed record
    //! гео-хэш вектор
    Edge: THashVector; // 16
  end;

  TEdgeListArray = TArray<TEdgeList>;

//------------------------------------------------------------------------------
//! запись в файле графов "реальный путь дороги"
//------------------------------------------------------------------------------
  PWay = ^TWay;

  TWay = packed record
    //! гео-координаты точки
    Mark: TGeoPosition; // 16
  end;

  TWayArray = TArray<TWay>;

//------------------------------------------------------------------------------
implementation

end.

