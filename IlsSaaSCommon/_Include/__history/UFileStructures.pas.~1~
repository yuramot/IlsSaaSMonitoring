unit UFileStructures;
//------------------------------------------------------------------------------
// все файловые структуры собраны тут
//
// !!! ВАЖНО !!!
//  размер абсолютно всех файловых структур должен быть кратен 8 байт
//  добавляйте пустое поле в конце при необходимости
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
interface

uses
  UGeoPosition;

//------------------------------------------------------------------------------
type

//------------------------------------------------------------------------------
//! запись в файле графов "дороги"
//------------------------------------------------------------------------------
  PEdge = ^TEdge;

  TEdge = packed record
    //! точка, в которую мы едем по этой дороге = геохэш-имя файла "точки"
    HubFile: Int64; // 8
    //! точка, в которую мы едем по этой дороге = индекс в файле "точки" (со знаком для совместимости???)
    HubOffset: Int64; // 16
    //! реальный путь по этой дороге = индекс в файле "путь"
    WayOffset: Int64; // 24
    //! кол-во точек в реальном пути в файле "путь"
    WayCount: Integer; // 28
    //! тип дороги
    RoadType: Integer; // 32
    //! длина дороги, километры
    Distance: Double; // 40
    //! стоимость проезда по дороге (=время?)
    Cost: Double; // 48
    //! пропуск для дороги
    Access: Integer; // 52
    //! делаем размер кратным 8
    Dummy: Integer; // 56
  end;

  TEdgeArray = TArray<TEdge>;

//------------------------------------------------------------------------------
//! запись в файле графов "точки"
//------------------------------------------------------------------------------
  PHub = ^THub;

  THub = packed record
    //! гео-координаты
    Coords: TGeoPosition; // 16
    //! список исходящих дорог = смещение в файле "список дорог"
    EdgesFromOffset: UInt64; // 24
    //! список входящих дорог = смещение в файле "список дорог"
    EdgesToOffset: UInt64; // 32
    //! кол-во исходящих дорог в файле "список дорог"
    EdgesFromCount: Integer; // 36
    //! кол-во входящих дорог в файле "список дорог"
    EdgesToCount: Integer; // 40
  end;

  THubArray = TArray<THub>;

//------------------------------------------------------------------------------
//! запись в файле графов "список дорог"
//------------------------------------------------------------------------------
  PEdgeList = ^TEdgeList;

  TEdgeList = packed record
    //! дорога = смещение в файле "дороги"
    EdgeOffset: UInt64; // 8
  end;

  TEdgeListArray = TArray<TEdgeList>;

//------------------------------------------------------------------------------
//! запись в файле графов "реальный путь дороги"
//------------------------------------------------------------------------------
  PWay = ^TWay;

  TWay = packed record
    //! гео-координаты точки
    Mark: TGeoPosition; // 16
  end;

  TWayArray = TArray<TWay>;

//------------------------------------------------------------------------------
implementation

end.

