unit UFileStructures;
//------------------------------------------------------------------------------
// все файловые структуры собраны тут
//
// !!! ВАЖНО !!!
//  размер абсолютно всех файловых структур должен быть кратен 8 байт
//  добавляйте пустое поле в конце при необходимости
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
interface

uses
  UGeoPosition, Generics.Collections;

//------------------------------------------------------------------------------
type

//------------------------------------------------------------------------------
//! структура гео-хэш вектор
//!   по сути - вектор из From в To, только выраженный через гео-хэши
//------------------------------------------------------------------------------
  PHashVector = ^THashVector;

  THashVector = packed record
    //! откуда
    PointFrom: Int64; // 8
    //! куда
    PointTo: Int64; // 16
  end;

  THashVectorArray = TArray<THashVector>;
//  ThashVectorDictionary = class(TDictionary<Int64, THashVectorArray>)
//    procedure Add(AValue: THashVector); overload;
//    destructor Destroy; override;
//  end;

//------------------------------------------------------------------------------
//! запись в файле графов "дороги"
//------------------------------------------------------------------------------
  PEdge = ^TEdge;

  TEdge = packed record
    //! гео-хэш вектора начало/конец
    VectorHash: THashVector; // 16
    //! гео-координаты начала
    CoordsFrom: TGeoPosition; // 32
    //! гео-координаты конца
    CoordsTo: TGeoPosition; // 48
    //! длина дороги, км
    Distance: Double; // 56
    //! максимальная скорость на дороге, км/ч
    MaxSpeed: Integer; // 60
    //! тип дороги
    RoadType: Integer; // 64
    //! индекс в файле списка дорог ".list_*"
    ListIndex: Integer; // 68
    //! количество дорог в файле списка дорог ".list_*"
    ListCount: Integer; // 72
    //! индекс в файле промежуточных точек ".way" (-1 если их нет)
    WayIndex: Integer; // 76
    //! количество промежуточных точек ".way" (может быть 0)
    WayCount: Integer; // 80
  end;

  TEdgeArray = TArray<TEdge>;

//------------------------------------------------------------------------------
implementation

end.

